namespace Core.Tests
{
    public class Tests
    {
        [SetUp]
        public void Setup()
        {
        }

        [Test]
        public void DNSMessage_QueryPayload1()
        {
            var payload = Convert.FromHexString("0000000000030010000000000C5F616972706C61792D626473045F746370056C6F63616C00000C8001085F616972706C6179C019000C8001055F72616F70C019000C8001C029000C000100000F510009064F6666696365C029C029000C000100000F51000E0B4C6976696E6720526F6F6DC029C029000C000100000F5100131053697474696E6720526F6F6D20283229C029C029000C000100000F51001714546F6D6173E2809973204D61632053747564696FC029C029000C000100000F5100100D46726F6E7420426564726F6F6DC029C029000C000100000F51000F0C4261636B20426564726F6F6DC029C029000C000100000FE1000F0C53697474696E6720526F6F6DC029C029000C000100001102000A074B69746368656EC029C038000C000100000F51001714414535463635464444443136404B69746368656EC038C038000C000100000F51001613333644453738434345324137404F6666696365C038C038000C000100000F5100242146413334393833373335344140546F6D6173E2809973204D61632053747564696FC038C038000C000100000F51001D1A4141313942364441384244334046726F6E7420426564726F6F6DC038C038000C000100000F51001C19413634324638423930384442404261636B20426564726F6F6DC038C038000C00010000101500201D3736383136423244393041334053697474696E6720526F6F6D20283229C038C038000C000100001015001B18374534413936383342304142404C6976696E6720526F6F6DC038C038000C000100001015001C194336444531453332414237384053697474696E6720526F6F6DC038");
            var message = new DNSMessage(payload);

            Assert.That(message.IsQuery, Is.True);
            Assert.That(message.Queries.Count, Is.EqualTo(3));
            Assert.That(message.Queries[0].Name, Is.EqualTo("_airplaybds._tcp.local"));
            Assert.That(message.Queries[1].Name, Is.EqualTo("_airplay._tcp.local"));
            Assert.That(message.Queries[2].Name, Is.EqualTo("_raop._tcp.local"));
        }

        [Test]
        public void DNSMessage_ResponsePayload1()
        {
            var payload = Convert.FromHexString(@"000084000000001200000000045F686170045F746370056C6F63616C00000C000100001194002614486F6D6562726964676520333431372035394331045F686170045F746370056C6F63616C0014486F6D6562726964676520333431372035394331045F686170045F746370056C6F63616C000021800100000078001F00000000CE2A1130455F36305F37335F34335F33345F3137056C6F63616C0014486F6D6562726964676520333431372035394331045F686170045F746370056C6F63616C000010800100001194004F0463233D350466663D301469643D30453A36303A37333A34333A33343A31370D6D643D686F6D656272696467650670763D312E310473233D310473663D310463693D320B73683D73446E3149773D3D1130455F36305F37335F34335F33345F3137056C6F63616C0000018001000000780004C0A8010A1130455F36305F37335F34335F33345F3137056C6F63616C00001C80010000007800102A028012125A0000BACA3AFFFE79D4D71130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000BACA3AFFFE79D4D71130455F36305F37335F34335F33345F3137056C6F63616C0000018001000000780004AC1200011130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000004256FFFE232E2F1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000883654FFFE14AC6C1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE8000000000000000AF77FFFEE4B45E1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE800000000000004CD992FFFE5A3DC61130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000E0DEC6FFFE9E7F871130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE800000000000003892D5FFFE6D713D1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000AC30B7FFFE08F46D1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000E83C81FFFEB21E8F1130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE800000000000002840C5FFFE5801551130455F36305F37335F34335F33345F3137056C6F63616C00001C8001000000780010FE80000000000000209111FFFE599BA3095F7365727669636573075F646E732D7364045F756470056C6F63616C00000C0001000011940011045F686170045F746370056C6F63616C00");

            var message = new DNSMessage(payload);
            Assert.That(message.IsQuery, Is.False);
        }

        [Test]
        public void DNSMessage_Test1()
        {
            var payload = Convert.FromHexString(@"0000840000000003000000030145014601330141013801350134013301340133014301430142013601340130013001300130013001300130013001300130013001300130013001380145014603697036046172706100000C80010000119400130B546F6D732D6950686F6E65056C6F63616C00033134300131033136380331393207696E2D61646472C050000C8001000011940002C06001420135013601300132013001320133013801390145014301370131013801300130013001300130014101350132013101320131013001380132013001410132C04C000C8001000011940002C060C00C002F8001000011940006C00C00020008C073002F8001000011940006C07300020008C097002F8001000011940006C09700020008");

            var message = new DNSMessage(payload);
            Assert.That(message.IsQuery, Is.False);
        }

        public void DNSMessage_Test2()
        {
            var payload = Convert.FromHexString("0000000000030000000500002446413132354543352D463141322D343334462D383143322D3832374638344530424631390E5F72656D6F746570616972696E67045F746370056C6F63616C0000FF80013935633A33653A31623A65303A33323A356440666538303A3A356533653A316266663A666565303A333235642D737570706F72747352502D32340E5F6170706C652D6D6F6264657632C04000FF80010B546F6D732D6950686F6E65C04500FF8001C00C0021000100001194000800000000C000C09FC05000210001000011940008000000007EF2C09FC09F001C0001000011940010FE80000000000000046BCC343458A3FEC09F00010001000011940004C0A8018CC09F001C00010000119400102A028012125A00000817CE983202065B");

            var message = new DNSMessage(payload);
            Assert.That(message.IsQuery, Is.False);
        }
    }
}